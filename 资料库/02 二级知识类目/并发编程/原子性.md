- 我们把一个或者多个操作在 CPU 执行的过程中不被中断的特性称为原子性

* “原子性”的本质是什么？其实不是不可分割，不可分割只是外在表现，其本质是多个资源间有一致性的要求，操作的中间状态对外不可见。
* 解决原子性问题，是要保证中间状态对外不可见。

- CPU 只能保证 CPU 指令级别的原子性，无法保证高级语言的操作符原子性

- 高级语言里一条语句往往需要多条 CPU 指令完成，例如上面代码中的 count += 1，至少需要三条 CPU 指令：
    - 指令 1：需要把变量 count 从内存加载到 CPU 的寄存器；
    - 指令 2：在寄存器中执行 +1 操作；
    - 指令 3：将结果写入内存（缓存机制导致可能写入的是 CPU 缓存而不是内存）。

- 这是违背我们直觉的地方。因此，很多时候我们需要在高级语言层面保证操作的原子性。

* 操作系统做任务切换，可以发生在任何一条 CPU 指令执行完